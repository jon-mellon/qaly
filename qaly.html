<html lang="en">
<head>
      

  <title>
    QALY App
  </title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <style>
  .right {
  position: absolute;
  right: 15px;
  padding: 0px;
  padding-top: 20px;
  }
  .left {
  position: absolute;
  left: 15px;
  padding: 0px;
  padding-top: 20px;
  }
  .center {
  position: absolute;
  left: 55px;
  right: 60px;
  padding: 10px;
  padding-bottom: 500px;
  }
  .centerbold {
          font-weight:bold;
          position: absolute;
          left: 55px;
          right: 60px;
          padding: 10px;
          padding-bottom: 500px;
  }

  .centerbutton {
    /*Change the width as much as you like, but make sure 
    margin-left and margin-right + width = 100%*/
    width:100%;
    margin-left:25%;
    margin-right:25%;
  }

  </style>
</head>
<body>
    <div class="container" id="questiontext">
        <p>questionPlaceholder</p>
    </div>

    <script id="SetupQALY">
        home = function () {
            window.location.href = "/qaly/index.html";
        }
        reset = function () {
            location.reload();
        }
        const queryString = window.location.search;
        const urlparams = new URLSearchParams(queryString);
        var maxchoices = 4;
        var loweranswerbad = "Life in this situation is not worth living";
        var loweranswergood = "Life in this situation still has some value";

        if (urlparams.get("scenario") == "currentvworst") {
            var mainQuestion = "Which of the following lives would you prefer?";

            var scenarioA = "Current situation";
            var shortScenarioA = "Current";
            var scenarioB = "Your worst past living situation";
            var finallowerquestion = "\nAre you saying that life in your worst past living situation would not be worth living?\n";
            var finalupperquestion = "\n  Is there any amount of life you would trade to avoid your worst past living situation?";
                        
        }

        if (urlparams.get("scenario") == "bestvcurrent") {
            var mainQuestion = "Which of the following lives would you prefer?";

            var scenarioA = "Best previous living situation";
            var shortScenarioA = "Best";
            var scenarioB = "Current situation";
            var finallowerquestion = "\nAre you saying that life in your current living situation is not worth living?\n";
            var finalupperquestion = "\n  Is there any amount of life you would trade to avoid your current living situation?";
            

        }

        if (urlparams.get("scenario") == "perfecthealthvcurrent") {
            var mainQuestion = "Which of the following lives would you prefer?";

            var scenarioA = "Perfect health";
            var shortScenarioA = "Perfect";
            var scenarioB = "Current health";
            var finallowerquestion = "\nAre you saying that life in your current health situation is not worth living?\n";
         

            var finalupperquestion = "\n  Is there any amount of life you would trade to avoid your current health situation?";
            

        }

        
         
        
        
        
        
    </script>


    <div class=centerbutton>
        <button onclick="pickA()" id="buttonA">Life A</button>
        <button onclick="pickB()" id="buttonB">Life B</button>
    </div>

    <h2>Life A</h2>

    <div class="container">
        <div class="center">
            <div class="progress" style="width: 100%; height:4.1rem" margin-left:auto>
                <div class="progress-bar progress-bar-success" id="progressA1" role="progressbar" style="width:50%">
                    <div class="container" id="scenarioAName" style="width: 100%; height:2.05rem" margin-left:auto>
                        ScenarioAPlaceholder
                    </div>
                    <div class="container" id="scenarioATime" style="width: 100%; height:2.05rem" margin-left:auto>
                        (5 years)
                    </div>
                        
                    </div>
                    <div class="progress-bar progress-bar-danger" id="progressA2" role="progressbar" style="width:50%">
                        Dead
                        <br>
                    </div>
                </div>

        </div>
        <div class="left">
            0 years
        </div>
        <div class="right">
            10 years
        </div>
    </div>

    <br>
    <br>
    <br>
    <br>
    <br>



    <h2>Life B</h2>
    <div class="container">
        <div class="center">

            <div class="progress" style="width: 100%; height:4.1rem" margin-left:auto>
                <div class="progress-bar progress-bar-warning" id="progressB" role="progressbar" style="width:100%">
                    <div class="container" id="scenarioBName">
                        scenarioBPlaceholder
                    </div>
                    <div class="container" id="scenarioBTime">
                        (10 years)
                    </div>
                    
                </div>
            </div>

        </div>
        <div class="left">
            0 years
        </div>
        <div class="right">
            10 years
        </div>
    </div>

    <script>
        var A1Name = document.getElementById("scenarioAName");
        var B1Name = document.getElementById("scenarioBName");
        var A1Time = document.getElementById("scenarioATime");
        var B1Time = document.getElementById("scenarioBTime");
        var qtext = document.getElementById("questiontext");
        var buttonA = document.getElementById("buttonA");
        var buttonB = document.getElementById("buttonB");
        var A1 = document.getElementById("progressA1");
        var A2 = document.getElementById("progressA2");

        var fontlargeslider = 12;
        var fontsmallslider = 9;

        

        A1Name.textContent = scenarioA;
        B1Name.textContent = scenarioB;
        qtext.textContent = mainQuestion;
    </script>
    
    <br>
    <br>
    <br>
    <br>
    <br>




    <script>
        var choicecount = 0;
        var bcount = 0;
        var acount = 0;
        var current = 50;
        var dead = 50;
        var jump = 25;
       
        pickA = function () {
            console.log("picked A");
            choicecount = choicecount + 1;
            acount = acount + 1;
            let counthtml = document.getElementById("choices");
            //counthtml.textContent = choicecount;
            
            dead = dead + jump;
            current = current - jump;
            jump = jump / 2;

            let daycurrent = Math.round(12 * ((current / 10) - Math.floor(current / 10)));
            let daydead = Math.round(12 * ((dead / 10) - Math.floor(dead / 10)));


            if (choicecount == (maxchoices +1)) {
                buttonA.hidden = true;
                buttonB.hidden = true;
                qtext.hidden = true;

                if (acount == (maxchoices +1)) {
                    A1.style.width = "0%";
                    A2.style.width = "100%";
                    A1.innerHTML = "0 years";
                    counthtml.textContent = "Record response: " + "0 years";
                } else {
                    counthtml.textContent = "Record response: " + "9 years 8 months";
                }
            } else {
                A1.style.width = current + "%";
                A2.style.width = dead + "%";
                let currentText;
                if (current > 20) {
                    currentText = Math.floor(current / 10) + ' years ' + daycurrent + " months";
                    A1Name.textContent = scenarioA;
                    A1Time.textContent = currentText;
                    A1Name.style.fontSize = fontlargeslider;
                    A1Time.style.fontSize = fontlargeslider;
                    //A1.innerHTML = "\n                  " + scenarioA + "\n                  <br>\n                  (" + currentText + ")\n                ";

                } else {
                    currentText = Math.round(current * 1.2) + " months";
                    A1Name.textContent = shortScenarioA;
                    A1Time.textContent = currentText;
                    A1Name.style.fontSize = fontsmallslider;
                    A1Time.style.fontSize = fontsmallslider;
                    //A1.innerHTML = "<font size= \"0.05\">\n                  " + shortScenarioA + "\n                  <br>\n                  (" + currentText + ")\n                </font>";

                }
                if (choicecount == maxchoices) {

                    if (acount == choicecount) {
                        qtext.textContent = finallowerquestion;
                        buttonA.textContent = loweranswerbad;
                        buttonB.textContent = loweranswergood;
                    } else {
                        buttonA.hidden = true;
                        buttonB.hidden = true;
                        qtext.hidden = true;
                        counthtml.textContent = "Record response: " + currentText;
                    }
                }
            }
        };
        pickB = function () {
            console.log("picked B");
            choicecount = choicecount + 1;
            bcount = bcount + 1;
            
            //let qtext = document.getElementById("questiontext");
            let counthtml = document.getElementById("choices");
            
            dead = dead - jump;
            current = current + jump;
            jump = jump / 2;
            let daycurrent = Math.round(12 * ((current / 10) - Math.floor(current / 10)));
            let daydead = Math.round(12 * ((dead / 10) - Math.floor(dead / 10)));

            if (choicecount == (maxchoices +1)) {
                buttonA.hidden = true;
                buttonB.hidden = true;
                qtext.hidden = true;

                if (bcount == (maxchoices +1)) {
                    A1.style.width = "100%";
                    A2.style.width = "0%";

                    A1.innerHTML = "10 years";
                    counthtml.textContent = "Record response: " + "10 years";
                } else {
                    counthtml.textContent = "Record response: " + "0 years 4 months";
                }
            } else {
                A1.style.width = current + "%";
                A2.style.width = dead + "%";
                //counthtml.textContent = choicecount;

                let currentText;
                if (current > 20) {
                    currentText = Math.floor(current / 10) + ' years ' + daycurrent + " months";
                    A1Name.textContent = scenarioA;
                    A1Time.textContent = currentText;
                    A1Name.style.fontSize = fontlargeslider;
                    A1Time.style.fontSize = fontlargeslider;
                } else {
                    currentText = Math.round(current * 1.2) + " months";
                    A1Name.textContent = shortScenarioA;
                    A1Time.textContent = currentText;
                    A1Name.style.fontSize = fontsmallslider;
                    A1Time.style.fontSize = fontsmallslider;
                }

                if (choicecount == maxchoices ) {

                    if (bcount == choicecount) {
                        qtext.textContent = finalupperquestion;
                        buttonA.textContent = "Yes";
                        buttonB.textContent = "No";

                    } else {
                        buttonA.hidden = true;
                        buttonB.hidden = true;
                        qtext.hidden = true;
                        counthtml.textContent = "Record response: " + currentText;
                    }
                }

            }
        };


    </script>
    <div class="center">
        <br>
        <br>

        <div class="centerbold" id="choices">

        </div>
                
        <br>
        <button onclick="reset()" id="resetButton">Reset</button>
        <br>
        <br>
        <button onclick="home()" id="homeButton">Return to home</button>
    </div>

</body>
</html>
